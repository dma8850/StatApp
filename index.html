<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Sports Stat Tracker</title>
<style>
body { font-family: Arial; margin:0; background:#f4f6f9; }
header { background:#1d3557; color:white; padding:15px; text-align:center; font-size:22px; }
nav { display:flex; background:#457b9d; }
nav button {
  flex:1;
  padding:12px;
  border:none;
  background:#457b9d;
  color:white;
  font-size:16px;
}
nav button.active { background:#1d3557; }
.section { display:none; padding:15px; }
.section.active { display:block; }
table { width:100%; border-collapse:collapse; margin-bottom:20px; }
th, td { border:1px solid #ccc; padding:6px; text-align:center; }
input { width:90%; padding:4px; }
select { width:100%; }
.publish-btn {
  width:100%;
  padding:14px;
  background:#1d3557;
  color:white;
  border:none;
  font-size:16px;
  margin-top:10px;
}
.summary-box {
  max-height:200px;
  overflow-y:auto;
  border:1px solid #ccc;
  padding:10px;
  background:white;
  margin-bottom:15px;
}
</style>
</head>
<body>

<header>Sports Stat Tracker</header>

<nav>
  <button onclick="showTab('nba')" class="active">NBA Boxscore</button>
  <button onclick="showTab('epl')">EPL Match</button>
  <button onclick="showTab('summary')">Summary</button>
</nav>

<!-- NBA SECTION -->
<div id="nba" class="section active">
<h2>NBA Boxscore</h2>

<label>Team 1:</label>
<select id="nbaTeam1"></select>
<label><input type="checkbox" id="nbaWin1"> Won</label>

<label>Team 2:</label>
<select id="nbaTeam2"></select>
<label><input type="checkbox" id="nbaWin2"> Won</label>

<h3>Team 1 Players</h3>
<table id="nbaTable1"></table>

<h3>Team 2 Players</h3>
<table id="nbaTable2"></table>

<button class="publish-btn" onclick="publishNBA()">Publish NBA Game</button>
</div>

<!-- EPL SECTION -->
<div id="epl" class="section">
<h2>EPL Match</h2>

<label>Team 1:</label>
<select id="eplTeam1"></select>
<label><input type="checkbox" id="eplWin1"> Won</label>

<label>Team 2:</label>
<select id="eplTeam2"></select>
<label><input type="checkbox" id="eplWin2"> Won</label>

<h3>Team 1 Players</h3>
<table id="eplTable1"></table>

<h3>Team 2 Players</h3>
<table id="eplTable2"></table>

<button class="publish-btn" onclick="publishEPL()">Publish EPL Match</button>
</div>

<!-- SUMMARY -->
<div id="summary" class="section">
<h2>Player Averages</h2>
<div class="summary-box" id="playerSummary"></div>

<h2>Team Records</h2>
<div class="summary-box" id="teamSummary"></div>

<button class="publish-btn" onclick="backupData()">Backup Data</button>
<input type="file" onchange="restoreData(event)">
</div>

<script>

const nbaTeams = [
"Atlanta Hawks","Boston Celtics","Brooklyn Nets","Charlotte Hornets",
"Chicago Bulls","Cleveland Cavaliers","Dallas Mavericks","Denver Nuggets",
"Detroit Pistons","Golden State Warriors","Houston Rockets","Indiana Pacers",
"LA Clippers","Los Angeles Lakers","Memphis Grizzlies","Miami Heat",
"Milwaukee Bucks","Minnesota Timberwolves","New Orleans Pelicans",
"New York Knicks","Oklahoma City Thunder","Orlando Magic",
"Philadelphia 76ers","Phoenix Suns","Portland Trail Blazers",
"Sacramento Kings","San Antonio Spurs","Toronto Raptors",
"Utah Jazz","Washington Wizards"
];

const eplTeams = [
"Arsenal","Aston Villa","Bournemouth","Brentford","Brighton",
"Chelsea","Crystal Palace","Everton","Fulham","Liverpool",
"Luton Town","Manchester City","Manchester United","Newcastle",
"Nottingham Forest","Sheffield United","Tottenham","West Ham","Wolves"
];

let players = JSON.parse(localStorage.getItem("players")) || {};
let teams = JSON.parse(localStorage.getItem("teams")) || {};

function showTab(id){
  document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  document.querySelectorAll('nav button').forEach(b=>b.classList.remove('active'));
  event.target.classList.add('active');
}

function fillSelect(id, list){
  const sel = document.getElementById(id);
  list.forEach(team=>{
    const opt = document.createElement("option");
    opt.value = team;
    opt.textContent = team;
    sel.appendChild(opt);
  });
}

function makeDropdown(){
  const select = document.createElement("select");
  for(let i=0;i<=100;i++){
    const opt = document.createElement("option");
    opt.value=i;
    opt.textContent=i;
    select.appendChild(opt);
  }
  return select;
}

function buildNBATable(id){
  const table = document.getElementById(id);
  table.innerHTML = "<tr><th>Name</th><th>PTS</th><th>REB</th><th>AST</th><th>STL</th><th>BLK</th></tr>";
  for(let i=0;i<10;i++){
    const row = document.createElement("tr");
    row.innerHTML="<td><input></td>";
    for(let j=0;j<5;j++){
      const td=document.createElement("td");
      td.appendChild(makeDropdown());
      row.appendChild(td);
    }
    table.appendChild(row);
  }
}

function buildEPLTable(id){
  const table = document.getElementById(id);
  table.innerHTML = "<tr><th>Name</th><th>Goals</th><th>Assists</th></tr>";
  for(let i=0;i<11;i++){
    const row = document.createElement("tr");
    row.innerHTML="<td><input></td>";
    for(let j=0;j<2;j++){
      const td=document.createElement("td");
      td.appendChild(makeDropdown());
      row.appendChild(td);
    }
    table.appendChild(row);
  }
}

function addPlayer(name, stats){
  if(!name) return;
  if(!players[name]) players[name]={games:0,...stats};
  else{
    for(let key in stats){
      players[name][key]=(players[name][key]||0)+stats[key];
    }
    players[name].games++;
  }
  players[name].games++;
}

function publishNBA(){
  processTable("nbaTable1",["pts","reb","ast","stl","blk"]);
  processTable("nbaTable2",["pts","reb","ast","stl","blk"]);
  recordTeam("nbaTeam1","nbaWin1");
  recordTeam("nbaTeam2","nbaWin2");
  save();
}

function publishEPL(){
  processTable("eplTable1",["goals","assists"]);
  processTable("eplTable2",["goals","assists"]);
  recordTeam("eplTeam1","eplWin1");
  recordTeam("eplTeam2","eplWin2");
  save();
}

function processTable(id, statKeys){
  const rows=document.getElementById(id).rows;
  for(let i=1;i<rows.length;i++){
    const name=rows[i].cells[0].children[0].value;
    if(!name) continue;
    let statObj={games:1};
    statKeys.forEach((k,index)=>{
      statObj[k]=parseInt(rows[i].cells[index+1].children[0].value);
    });
    addPlayer(name, statObj);
  }
}

function recordTeam(teamId, winId){
  const team=document.getElementById(teamId).value;
  const win=document.getElementById(winId).checked;
  if(!teams[team]) teams[team]={wins:0,losses:0};
  if(win) teams[team].wins++;
  else teams[team].losses++;
}

function save(){
  localStorage.setItem("players",JSON.stringify(players));
  localStorage.setItem("teams",JSON.stringify(teams));
  updateSummary();
  alert("Published!");
}

function updateSummary(){
  let html="";
  for(let name in players){
    html+=`<b>${name}</b> (${players[name].games} games)<br>`;
    for(let key in players[name]){
      if(key!=="games"){
        html+=`${key}: ${(players[name][key]/players[name].games).toFixed(1)} `;
      }
    }
    html+="<br><br>";
  }
  document.getElementById("playerSummary").innerHTML=html;

  let teamHtml="";
  for(let t in teams){
    teamHtml+=`${t}: ${teams[t].wins}W - ${teams[t].losses}L<br>`;
  }
  document.getElementById("teamSummary").innerHTML=teamHtml;
}

function backupData(){
  const blob=new Blob([JSON.stringify({players,teams})],{type:"application/json"});
  const a=document.createElement("a");
  a.href=URL.createObjectURL(blob);
  a.download="backup.json";
  a.click();
}

function restoreData(e){
  const file=e.target.files[0];
  const reader=new FileReader();
  reader.onload=function(){
    const data=JSON.parse(reader.result);
    players=data.players;
    teams=data.teams;
    save();
  };
  reader.readAsText(file);
}

fillSelect("nbaTeam1",nbaTeams);
fillSelect("nbaTeam2",nbaTeams);
fillSelect("eplTeam1",eplTeams);
fillSelect("eplTeam2",eplTeams);

buildNBATable("nbaTable1");
buildNBATable("nbaTable2");
buildEPLTable("eplTable1");
buildEPLTable("eplTable2");

updateSummary();

</script>

</body>
</html>
