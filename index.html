<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Sports Stat Tracker</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body { font-family: Arial, sans-serif; margin:0; padding:20px; background:#f4f6f8; color:#333; }
h1 { text-align:center; color:#1e3a8a; margin-bottom:20px; }
.tab-buttons {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
    gap: 8px;
    justify-items: center;
    margin-bottom: 20px;
}
.tab-buttons button {
    width: 100%; padding:10px 0; border:none; border-radius:12px; background:#1e40af; color:white; font-weight:bold; cursor:pointer; transition:0.3s;
}
.tab-buttons button.active { background:#2563eb; }
#btn-epl-box, #btn-epl-summary { background:#059669; }
#btn-epl-box.active, #btn-epl-summary.active { background:#10b981; }
.tab { display:none; }
.team-card { background:white; border-radius:12px; padding:15px; margin-bottom:20px; box-shadow:0 2px 6px rgba(0,0,0,0.15);}
#eplBox .team-card, #eplSummary .scroll-box { background:#d1fae5; }
.team-card h3 { margin-top:0; color:#1e3a8a; }
table { width:100%; border-collapse:collapse; margin-bottom:10px; }
th, td { border:1px solid #ccc; padding:8px; text-align:center; border-radius:6px; }
input[type="text"], select { width:80%; padding:5px; border-radius:6px; border:1px solid #ccc; text-align:center; }
input[type="checkbox"] { transform:scale(1.2); }
button.publish { width:100%; padding:15px; background:#10b981; color:white; font-size:18px; font-weight:bold; border:none; border-radius:12px; cursor:pointer; margin-top:10px; }
button.publish:hover { background:#059669; }
#leaderboardNBA p, #leaderboardEPL p { background:#e0f2fe; padding:8px; border-radius:8px; margin:5px 0; font-weight:bold; }
.scroll-box { max-height:180px; overflow-y:auto; border:1px solid #ccc; padding:10px; border-radius:12px; background:white; }
.scroll-box p:nth-child(odd) { background:#f0f9ff; padding:5px; border-radius:6px; }
</style>
</head>
<body>

<h1>Sports Stat Tracker</h1>

<div class="tab-buttons">
<button id="btn-nba-box" onclick="showTab('nbaBox')">NBA Boxscore</button>
<button id="btn-nba-summary" onclick="showTab('nbaSummary')">NBA Summary</button>
<button id="btn-epl-box" onclick="showTab('eplBox')">EPL Match</button>
<button id="btn-epl-summary" onclick="showTab('eplSummary')">EPL Summary</button>
</div>

<!-- NBA BOX -->
<div id="nbaBox" class="tab">
<div class="team-card">
<select id="nbaTeam1" onchange="prefillRoster('NBA', this.value, 'nbaTeam1Players')"></select>
<input type="checkbox" id="nbaTeam1Win"> Winner
<h3>Team 1 Players</h3>
<div id="nbaTeam1Players"></div>
</div>

<div class="team-card">
<select id="nbaTeam2" onchange="prefillRoster('NBA', this.value, 'nbaTeam2Players')"></select>
<input type="checkbox" id="nbaTeam2Win"> Winner
<h3>Team 2 Players</h3>
<div id="nbaTeam2Players"></div>
</div>

<button class="publish" onclick="publishNBA()">Publish NBA Game</button>
</div>

<!-- NBA SUMMARY -->
<div id="nbaSummary" class="tab">
<h2>NBA Summary</h2>
<div id="leaderboardNBA"></div>
<h3>Team Records</h3>
<div class="scroll-box" id="teamRecordsNBA"></div>
</div>

<!-- EPL BOX -->
<div id="eplBox" class="tab">
<div class="team-card">
<select id="eplTeam1" onchange="prefillRoster('EPL', this.value, 'eplTeam1Players')"></select>
<input type="checkbox" id="eplTeam1Win"> Winner
<h3>Team 1 Players</h3>
<div id="eplTeam1Players"></div>
</div>

<div class="team-card">
<select id="eplTeam2" onchange="prefillRoster('EPL', this.value, 'eplTeam2Players')"></select>
<input type="checkbox" id="eplTeam2Win"> Winner
<h3>Team 2 Players</h3>
<div id="eplTeam2Players"></div>
</div>

<button class="publish" onclick="publishEPL()">Publish EPL Match</button>
</div>

<!-- EPL SUMMARY -->
<div id="eplSummary" class="tab">
<h2>EPL Summary</h2>
<div id="leaderboardEPL"></div>
<h3>Team Records</h3>
<div class="scroll-box" id="teamRecordsEPL"></div>
</div>

<script>
// --- Teams ---
const nbaTeams = ["Hawks","Celtics","Nets","Hornets","Bulls","Cavaliers","Mavericks","Nuggets",
"Pistons","Warriors","Rockets","Pacers","Clippers","Lakers","Grizzlies","Heat",
"Bucks","Timberwolves","Pelicans","Knicks","Thunder","Magic","76ers","Suns",
"Trail Blazers","Kings","Spurs","Raptors","Jazz","Wizards"];
const eplTeams = ["Arsenal","Aston Villa","Bournemouth","Brentford","Brighton","Chelsea","Crystal Palace","Everton",
"Fulham","Liverpool","Luton","Man City","Man United","Newcastle","Nottingham","Sheffield United",
"Tottenham","West Ham","Wolves","Bournemouth"];

// --- Storage ---
let playersDataNBA = JSON.parse(localStorage.getItem("playersDataNBA"))||{};
let teamRecordsNBA = JSON.parse(localStorage.getItem("teamRecordsNBA"))||{};
let lastRosterNBA = JSON.parse(localStorage.getItem("lastRosterNBA"))||{};
let playersDataEPL = JSON.parse(localStorage.getItem("playersDataEPL"))||{};
let teamRecordsEPL = JSON.parse(localStorage.getItem("teamRecordsEPL"))||{};
let lastRosterEPL = JSON.parse(localStorage.getItem("lastRosterEPL"))||{};

// --- Initialize ---
function populateTeams() {
  nbaTeams.forEach(t=>{ nbaTeam1.add(new Option(t,t)); nbaTeam2.add(new Option(t,t)); });
  eplTeams.forEach(t=>{ eplTeam1.add(new Option(t,t)); eplTeam2.add(new Option(t,t)); });
}
function createPlayerTable(containerId, stats) {
  let container = document.getElementById(containerId);
  let table = `<table><tr><th>Name</th>${stats.map(s=>`<th>${s}</th>`).join("")}</tr>`;
  for(let i=0;i<11;i++){
    table += `<tr><td><input type="text" class="name" placeholder="Player Name"></td>`;
    stats.forEach(s=>table += `<td>${createStatDropdown(s)}</td>`);
    table += "</tr>";
  }
  table += "</table>";
  container.innerHTML = table;
}
function createStatDropdown(stat) {
  let max = stat==="Goals"||stat==="Assists"?10:100;
  let sel = '<select class="stat">';
  for(let i=0;i<=max;i++) sel+=`<option value="${i}">${i}</option>`;
  sel+='</select>';
  return sel;
}

// --- Prefill roster on team select ---
function prefillRoster(league, teamName, containerId){
  if(!teamName) return;
  let rosterKey = league==="NBA" ? lastRosterNBA : lastRosterEPL;
  let table = document.getElementById(containerId).querySelector("table");
  if(!table) return;
  for(let i=0;i<11;i++){
    let input = table.rows[i+1].querySelector(".name");
    input.value = rosterKey[teamName] && rosterKey[teamName][i] ? rosterKey[teamName][i] : "";
  }
}

// --- Generic processing ---
function processTeam(teamName, won, container, playersData, teamRecords, lastRoster){
  if(!teamRecords[teamName]) teamRecords[teamName]={wins:0, losses:0};
  won ? teamRecords[teamName].wins++ : teamRecords[teamName].losses++;
  let roster=[];
  container.querySelectorAll("tr").forEach((row,i)=>{
    if(i===0) return;
    let name=row.querySelector(".name").value;
    roster.push(name);
    if(!name) return;
    let statElems=row.querySelectorAll(".stat");
    let statKeys = statElems.length===2?["Goals","Assists"]:["PTS","REB","AST","STL","BLK"];
    if(!playersData[name]) playersData[name]={games:0};
    statKeys.forEach(k=>{ if(!playersData[name][k]) playersData[name][k]=0; });
    statKeys.forEach((k,idx)=>playersData[name][k]+=+statElems[idx].value);
    playersData[name].games++;
  });
  lastRoster[teamName]=roster;
}

// --- Publish NBA ---
function publishNBA(){
  processTeam(nbaTeam1.value, nbaTeam1Win.checked, document.getElementById("nbaTeam1Players"), playersDataNBA, teamRecordsNBA, lastRosterNBA);
  processTeam(nbaTeam2.value, nbaTeam2Win.checked, document.getElementById("nbaTeam2Players"), playersDataNBA, teamRecordsNBA, lastRosterNBA);
  localStorage.setItem("playersDataNBA", JSON.stringify(playersDataNBA));
  localStorage.setItem("teamRecordsNBA", JSON.stringify(teamRecordsNBA));
  localStorage.setItem("lastRosterNBA", JSON.stringify(lastRosterNBA));
  alert("NBA Game Published!");
  updateSummaryNBA();
}

// --- Publish EPL ---
function publishEPL(){
  processTeam(eplTeam1.value, eplTeam1Win.checked, document.getElementById("eplTeam1Players"), playersDataEPL, teamRecordsEPL, lastRosterEPL);
  processTeam(eplTeam2.value, eplTeam2Win.checked, document.getElementById("eplTeam2Players"), playersDataEPL, teamRecordsEPL, lastRosterEPL);
  localStorage.setItem("playersDataEPL", JSON.stringify(playersDataEPL));
  localStorage.setItem("teamRecordsEPL", JSON.stringify(teamRecordsEPL));
  localStorage.setItem("lastRosterEPL", JSON.stringify(lastRosterEPL));
  alert("EPL Match Published!");
  updateSummaryEPL();
}

// --- Update summaries ---
function updateSummaryNBA(){
  let html="<h3>Leaders (Per Game Averages)</h3>";
  let leaders={PTS:null, REB:null, AST:null, STL:null, BLK:null};
  for(let n in playersDataNBA){
    let p=playersDataNBA[n]; let avg={PTS:p.PTS/p.games, REB:p.REB/p.games, AST:p.AST/p.games, STL:p.STL/p.games, BLK:p.BLK/p.games};
    for(let stat in leaders) if(!leaders[stat] || avg[stat]>leaders[stat].value) leaders[stat]={name:n,value:avg[stat]};
  }
  for(let stat in leaders) if(leaders[stat]) html+=`<p>${stat}: ${leaders[stat].name} (${leaders[stat].value.toFixed(1)})</p>`;
  document.getElementById("leaderboardNBA").innerHTML=html;
  let recHTML=""; for(let t in teamRecordsNBA) recHTML+=`<p>${t}: ${teamRecordsNBA[t].wins}W - ${teamRecordsNBA[t].losses}L</p>`;
  document.getElementById("teamRecordsNBA").innerHTML=recHTML;
}
function updateSummaryEPL(){
  let html="<h3>Leaders (Per Game Averages)</h3>";
  let leaders={Goals:null, Assists:null};
  for(let n in playersDataEPL){
    let p=playersDataEPL[n]; let avg={Goals:p.Goals/p.games, Assists:p.Assists/p.games};
    for(let stat in leaders) if(!leaders[stat] || avg[stat]>leaders[stat].value) leaders[stat]={name:n,value:avg[stat]};
  }
  for(let stat in leaders) if(leaders[stat]) html+=`<p>${stat}: ${leaders[stat].name} (${leaders[stat].value.toFixed(1)})</p>`;
  document.getElementById("leaderboardEPL").innerHTML=html;
  let recHTML=""; for(let t in teamRecordsEPL) recHTML+=`<p>${t}: ${teamRecordsEPL[t].wins}W - ${teamRecordsEPL[t].losses}L</p>`;
  document.getElementById("teamRecordsEPL").innerHTML=recHTML;
}

// --- Tab switching ---
function showTab(id){
  document.querySelectorAll(".tab").forEach(t=>t.style.display="none");
  document.getElementById(id).style.display="block";
  document.querySelectorAll(".tab-buttons button").forEach(b=>b.classList.remove("active"));
  if(id==="nbaBox") btn-nba-box.classList.add("active");
  if(id==="nbaSummary") btn-nba-summary.classList.add("active");
  if(id==="eplBox") btn-epl-box.classList.add("active");
  if(id==="eplSummary") btn-epl-summary.classList.add("active");
  updateSummaryNBA(); updateSummaryEPL();
}

// --- Initialize ---
populateTeams();
createPlayerTable("nbaTeam1Players",["PTS","REB","AST","STL","BLK"]);
createPlayerTable("nbaTeam2Players",["PTS","REB","AST","STL","BLK"]);
createPlayerTable("eplTeam1Players",["Goals","Assists"]);
createPlayerTable("eplTeam2Players",["Goals","Assists"]);
showTab("nbaBox");
</script>

</body>
</html>
